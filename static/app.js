var app={};app.additionalScripts={},app.additionalScripts["Duration Compare"]="/static/lib/juration.js";var getScript=function(e,p){var r=document.createElement("script"),o=document.getElementsByTagName("script")[0];r.async=1,o.parentNode.insertBefore(r,o),r.onload=r.onreadystatechange=function(e,o){(o||!r.readyState||/loaded|complete/.test(r.readyState))&&(r.onload=r.onreadystatechange=null,r=void 0,o||p&&p())},r.src=e};app.getProblem=function(){var e=window.location.href.substring(window.location.href.lastIndexOf("/")+1);if(!e){var p=new Date,r=p.getDate(),o=p.getMonth()+1,n=p.getFullYear();e=n+"-"+o+"-"+r}var t=m.prop([]);return m.request({method:"GET",url:"/api/v1/problems/"+e,unwrapError:function(e){return console.log(e.errors),e.errors}}).then(t).then(function(e){e.problems.map(function(e){app.additionalScripts[e.solution.method]&&getScript(app.additionalScripts[e.solution.method])})}),t},app.levels=[{title:"High School",level:0},{title:"College",level:1}],app.vm={},app.vm.init=function(){app.vm.problem=app.getProblem(),app.vm.levels=app.levels,app.vm.user={answer:m.prop(""),level:0,showHint:m.prop(!1),showAnswerBox:m.prop(!1),showDescription:m.prop(!1),showAnswer:m.prop(!1)},app.vm.compare={},app.vm.compare["Duration Compare"]=function(e,p){return app.vm.propy(juration.parse(e)==juration.parse(p))},app.vm.compare["Numerical Compare"]=function(e,p){return app.vm.propy(e==p)},app.vm.propy=function(e){return e?m.prop(!0):m.prop(!1)},app.vm.showLevels=function(){return app.vm.propy(app.vm.problem().problems.length>1)},app.vm.showHintBox=function(){return app.vm.propy(app.vm.problem().problems[app.vm.user.level].hint)},app.vm.isAnswerCorrect=function(){var e=app.vm.problem().problems[app.vm.user.level].solution;return app.vm.compare[e.method](e.answer,app.vm.user.answer())},app.vm.toggle=function(e){e(!e())},app.vm.opposite=function(e){return m.prop(!e())},app.vm.forceTrue=function(e){e(!0)},app.vm.display=function(e){return e()?"block":"none"},app.vm.changeLevel=function(e){app.vm.user.level=e,app.vm.user.showHint(!1),app.vm.user.showAnswerBox(!1),app.vm.user.showAnswer(!1),app.vm.user.showDescription(!1),app.vm.user.answer("")}},app.controller=function(){app.vm.init(),this.doNothing=function(){return!1}};var renderKatex=function(e){for(var p="",r=e.indexOf("$");-1!==r;){var o=r+1,n=e.indexOf("$",o),t=e.substring(o,n);t=t.replace(/(?:\r\n|\r|\n)/g,"<br />"),p=p.concat(e.substring(0,o-1)+katex.renderToString(t)),e=e.substring(n+1),r=e.indexOf("$")}return p=p.concat(e.substring(r))};app.view=function(e){var p=app.vm.user;return[m(".controls",m("h2",app.vm.problem().problems[p.level].name),m("ul",{style:{display:app.vm.display(app.vm.showLevels())}},app.vm.levels.map(function(r){return m("li",m(r.level==p.level?"span.current":"button",{onclick:app.vm.changeLevel.bind(e,r.level)},r.title))})),m(".postControls",m("p#date",app.vm.problem().problems[p.level].date),m("p#category",app.vm.problem().problems[p.level].category))),m("#problem",p.showAnswerBox()?app.vm.isAnswerCorrect()()?m(".flex",m("h1","Correct!"),m("p",p.answer()+" is a valid response! New problems every Monday, Wednesday, and Friday!")):m("#incorrect",m("h3",p.showAnswer()?"Answer: "+app.vm.problem().problems[p.level].solution.answer:"Sorry, that's not correct!"),m(".buttons",m("button#try",{onclick:app.vm.toggle.bind(this,p.showAnswerBox)},"Try Again"),m("button.error",{style:{display:app.vm.display(app.vm.opposite(p.showAnswer))},onclick:app.vm.forceTrue.bind(this,p.showAnswer)},"Show Answer"),m("button.warning",{style:{display:app.vm.display(p.showAnswer)},onclick:app.vm.toggle.bind(this,p.showDescription)},p.showDescription()?"Hide Description":"Show Description")),m("pre",{style:{display:p.showDescription()?"block":"none"}},m.trust(renderKatex(app.vm.problem().problems[p.level].answer_desc)))):m("pre",m.trust(renderKatex(app.vm.problem().problems[p.level].problem)))),m(".row#hint",m(".fourth",m("button",{onclick:app.vm.toggle.bind(this,p.showHint),style:{display:app.vm.display(app.vm.showHintBox())}},p.showHint()?"Hide Hint":"Show Hint")),m("p",p.showHint()?m.trust(renderKatex(app.vm.problem().problems[p.level].hint)):"")),m("form",{onsubmit:e.doNothing.bind(e)},m("label",{"for":"answer"},"Answer:"),m("input[type=text]",{value:p.answer(),id:"answer",placeholder:"Enter your answer here",autocomplete:"off",onchange:m.withAttr("value",p.answer)}),m("input",{type:"submit",value:"Submit",onclick:app.vm.forceTrue.bind(e,p.showAnswerBox)}))]};